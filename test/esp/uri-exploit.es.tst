/*
    uri-exploit.tst - Test HTML injection in URI
 */

const HTTP = tget('TM_HTTP') || "127.0.0.1:4100"
let http: Http = new Http

http.get(HTTP + "/directives.esp?weather=sunny&exploit=<html>")
let caught
try {
    ttrue(http.status == 200)
    ttrue(http.response.contains('Safe Variables: &lt;html&gt;'))
} catch (e) {
    caught = true
}
ttrue(!caught);
http.close()
